{% load i18n adminmedia sekizai_tags %}
{% addtoblock "js" %}<script type="text/javascript" src="{{ CMS_MEDIA_URL }}js/plugins/cms.placeholders.js"></script>{% endaddtoblock %}
{% addtoblock "css" %}<link rel="stylesheet" type="text/css" href="{{ CMS_MEDIA_URL }}css/plugins/cms.placeholders.css?v1" media="all" />{% endaddtoblock %}
{% addtoblock "js" %}
<script type="text/javascript">
//<![CDATA[
jQuery(document).ready(function ($) {
	// initialize placeholders, pass options and keep it private
	CMS.Placeholders = new CMS.Placeholders('#cms_toolbar', {
		{% if request.toolbar.edit_mode %}'edit_mode': true,{% endif %}
		'urls': {
		    {% for key, url in urls.items %}
		    '{{ key }}': '{{ url }}',
		    {% endfor %}
			'change_template_url': {% if page %}'{% url admin:cms_page_change_template page.pk %}'{% else %}null{% endif %},
		},
		'lang': {
			'move_warning': '{% trans "The selected element can not be moved to the desired location." %}',
			'delete_request': '{% trans "Are you sure you want to delete this plugin?" %}',
			'cancel': '{% trans "Cancel" %}'
		}
	});
});
//]]>
</script>
{% endaddtoblock %}
<!-- load placeholder bar -->
<div class="cms_placeholder-bar cms_reset cms_placeholder::{{ language }}::{{ page.id }}::{{ placeholder.pk }}:: cms_placeholder_slot::{{ placeholder.slot }}">
	<div class="cms_placeholder-title">{{ placeholder_label }}</div>
	<div class="cms_placeholder-btn">
		<a href="#" class="cms_toolbar-btn cms_toolbar-btn_left">
			<span class="cms_toolbar-btn_right">
				<span class="cms_toolbar_title">&nbsp;{% trans "Add" %}</span>
				<span class="cms_toolbar_icon cms_toolbar_icon-more">-</span>
			</span>
		</a>
		<ul class="cms_placeholder-subnav">				
			{% regroup installed_plugins by module as module_list %}
			{% for module in module_list %}
			<li class="cms_placeholder-subnav-title"><span>{% if module.grouper %}{{ module.grouper|capfirst }}{% else %}{% trans "Available plugins" %}{% endif %}</span>
			<ul>
				{% for p in module.list %}
				<li{% if forloop.first %} class="cms_placeholder-first"{% endif %}{% if forloop.last %} class="cms_placeholder-last"{% endif %}><a href="#" rel="type::{{ p.value }}">{{ p.name }}</a></li>
				{% endfor %}
			</ul>
			</li>
			{% endfor %}
		</ul>
	</div>
</div>